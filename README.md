# CLI Calculator

Rust로 작성된 간단한 명령줄 계산기입니다. 다양한 수학 연산과 계산 히스토리 기능을 제공합니다.

## ✨ 주요 기능

- **기본 연산**: 덧셈(`+`), 뺄셈(`-`), 곱셈(`*`), 나눗셈(`/`)
- **고급 연산**: 모듈로(`%`), 제곱(`^`), 제곱근(`sqrt()`)
- **연산자 우선순위**: 수학적 우선순위에 따라 자동 계산
- **괄호 지원**: 복잡한 표현식 계산 가능
- **음수 지원**: 음수 숫자 및 단항 연산자 지원
- **계산 히스토리**: 최근 50개의 계산 기록 저장 및 조회
- **마지막 결과 재사용**: `ans` 키워드로 이전 결과 사용
- **부동소수점 정밀도 처리**: 깔끔한 결과 표시

## 🚀 설치 및 실행

### 요구사항

- Rust 1.70 이상
- Cargo (Rust 패키지 매니저)

### 빌드 및 실행

```bash
# 저장소 클론
git clone <repository-url>
cd cli_calcul

# 빌드
cargo build --release

# 실행
cargo run

# 또는 릴리즈 빌드 실행
./target/release/cli_calcul
```

## 📖 사용 방법

### 기본 사용

프로그램을 실행하면 프롬프트(`>`)가 나타납니다. 수학 표현식을 입력하면 결과가 표시됩니다.

```
> 2 + 3 * 4
Result: 14

> (2 + 3) * 4
Result: 20

> sqrt(16) + 2^3
Result: 12

> 10 % 3
Result: 1
```

### 명령어

- `history` 또는 `h` - 계산 히스토리 보기
- `clear` 또는 `c` - 히스토리 지우기
- `help` 또는 `?` - 도움말 보기
- `exit` 또는 `quit` - 프로그램 종료

### 마지막 결과 사용 (`ans`)

`ans` 키워드를 사용하여 이전 계산 결과를 표현식에 사용할 수 있습니다.

```
> 10 + 5
Result: 15

> ans * 2
Result: 30

> ans + 10
Result: 40
```

### 계산 히스토리

```
> 2 + 3
Result: 5

> 5 * 4
Result: 20

> history
--- Calculation History ---
1: 2 + 3 = 5
2: 5 * 4 = 20
---------------------------
```

## 💡 사용 예시

### 기본 연산

```
> 10 + 20 - 5
Result: 25

> 2 * 3 + 4 * 5
Result: 26

> 10 / 3
Result: 3.3333333333
```

### 고급 연산

```
> 2^3
Result: 8

> 2^3^2
Result: 512

> sqrt(16)
Result: 4

> sqrt(2 + 2)
Result: 2

> 10 % 3
Result: 1
```

### 괄호 사용

```
> (2 + 3) * 4
Result: 20

> ((2 + 3) * 4) + 5
Result: 25

> 2 * (3 + 4)
Result: 14
```

### 음수 사용

```
> -5 + 3
Result: -2

> -5 * 2
Result: -10

> -(-5)
Result: 5

> (-2 + 3) * 4
Result: 4
```

### 복잡한 표현식

```
> sqrt(16) + 2^3 * 2
Result: 20

> (10 - 5) / (2 + 3)
Result: 1

> ans * 10
Result: 10
```

## 🏗️ 프로젝트 구조

```
src/
├── main.rs          # CLI 인터페이스 및 히스토리 관리
└── calc/            # 계산 엔진 모듈
    ├── mod.rs       # 모듈 선언 및 공개 API
    ├── token.rs     # 토큰화 (문자열 → 토큰)
    ├── parser.rs    # 파싱 및 평가 (토큰 → 결과)
    ├── format.rs    # 결과 포맷팅
    └── calcul.rs    # 메인 계산 인터페이스
```

### 모듈 설명

- **`token.rs`**: 표현식을 토큰(숫자, 연산자 등)으로 분리
- **`parser.rs`**: 재귀 하강 파서를 사용하여 토큰을 파싱하고 평가
- **`format.rs`**: 부동소수점 정밀도 처리 및 결과 포맷팅
- **`calcul.rs`**: 공개 API (`evl_ex` 함수)

## 🔧 기술 스택

- **언어**: Rust
- **의존성**: 
  - `regex` (현재는 사용하지 않지만 Cargo.toml에 포함됨)

## 📝 연산자 우선순위

1. **제곱** (`^`) - 우측 결합, 가장 높은 우선순위
2. **곱셈, 나눗셈, 모듈로** (`*`, `/`, `%`) - 왼쪽에서 오른쪽으로
3. **덧셈, 뺄셈** (`+`, `-`) - 왼쪽에서 오른쪽으로

## 🐛 알려진 제한사항

- 현재는 단일 표현식만 계산 가능 (변수 할당 불가)
- 함수는 `sqrt()`만 지원
- 복소수 미지원

---

**즐거운 계산 되세요! 🧮**
